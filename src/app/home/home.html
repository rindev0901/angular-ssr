<p-toast />

<div class="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 py-8 px-4">
  <div class="max-w-4xl mx-auto">
    <!-- Header -->
    <div class="text-center mb-8">
      <h1 class="text-5xl font-bold text-gray-800 mb-2">
        <i class="pi pi-check-circle text-indigo-600 mr-3"></i>
        My Todos
      </h1>
      <p class="text-gray-600 text-lg">Stay organized and productive</p>
    </div>

    <!-- Stats Cards -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
      <p-card class="shadow-lg">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-gray-500 text-sm font-medium">Total Tasks</p>
            <p class="text-3xl font-bold text-gray-800">{{ todos().length }}</p>
          </div>
          <div class="bg-blue-100 size-8 rounded-full flex items-center justify-center">
            <i class="pi pi-list text-blue-600 size-4"></i>
          </div>
        </div>
      </p-card>

      <p-card class="shadow-lg">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-gray-500 text-sm font-medium">Active</p>
            <p class="text-3xl font-bold text-orange-600">{{ activeCount }}</p>
          </div>
          <div class="bg-orange-100 size-8 rounded-full flex items-center justify-center">
            <i class="pi pi-clock text-orange-600 size-4"></i>
          </div>
        </div>
      </p-card>

      <p-card class="shadow-lg">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-gray-500 text-sm font-medium">Completed</p>
            <p class="text-3xl font-bold text-green-600">{{ completedCount }}</p>
          </div>
          <div class="bg-green-100 size-8 rounded-full flex items-center justify-center">
            <i class="pi pi-check text-green-600 size-4"></i>
          </div>
        </div>
      </p-card>
    </div>

    <!-- Add Todo Card -->
    <p-card class="shadow-xl mb-6 border-t-4 border-indigo-500">
      <ng-template pTemplate="header">
        <div class="px-6 pt-6">
          <h2 class="text-2xl font-bold text-gray-800 flex items-center">
            <i class="pi pi-plus-circle text-indigo-600 mr-2"></i>
            Add New Todo
          </h2>
        </div>
      </ng-template>

      <div class="flex gap-3">
        <p-iconfield iconPosition="left" class="flex-1">
          <p-inputicon styleClass="pi pi-pencil" />
          <input
            type="text"
            pInputText
            [(ngModel)]="newTodoTitle"
            (keyup.enter)="addTodo()"
            placeholder="What needs to be done?"
            class="w-full"
          />
        </p-iconfield>

        <button pButton (click)="addTodo()" [disabled]="!newTodoTitle().trim()" severity="success">
          <i class="pi pi-plus" pButtonIcon></i>
          <span pButtonLabel>Add</span>
        </button>
      </div>
    </p-card>

    <!-- Todos List -->
    <div class="space-y-4">
      @if (loading()) {
      <p-card class="shadow-lg">
        <div class="text-center py-12">
          <i class="pi pi-spin pi-spinner text-4xl text-indigo-600 mb-4"></i>
          <p class="text-gray-600">Loading todos...</p>
        </div>
      </p-card>
      } @else if (todos().length === 0) {
      <p-card class="shadow-lg">
        <div class="text-center py-12">
          <i class="pi pi-inbox text-6xl text-gray-300 mb-4"></i>
          <h3 class="text-xl font-semibold text-gray-700 mb-2">No todos yet</h3>
          <p class="text-gray-500">Add your first todo to get started!</p>
        </div>
      </p-card>
      } @else { @for (todo of todos(); track todo.id) {
      <p-card
        [class]="
          'shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 border-l-4 ' +
          (todo.completed ? 'border-green-500 bg-green-50/30' : 'border-indigo-500')
        "
      >
        <div class="flex items-center gap-4">
          <!-- Checkbox -->
          <p-checkbox
            [(ngModel)]="todo.completed"
            [binary]="true"
            (onChange)="toggleTodo(todo)"
            inputId="todo-{{ todo.id }}"
            class="shrink-0"
          />

          <!-- Todo Content -->
          <div class="flex-1 min-w-0">
            <label
              [for]="'todo-' + todo.id"
              [class]="
                'text-lg cursor-pointer block ' +
                (todo.completed ? 'line-through text-gray-500' : 'text-gray-800 font-medium')
              "
            >
              {{ todo.title }}
            </label>

            <div class="flex items-center gap-3 mt-2">
              @if (todo.completed) {
              <p-chip
                label="Completed"
                icon="pi pi-check"
                styleClass="bg-green-100 text-green-700"
              />
              } @else {
              <p-chip
                label="Active"
                icon="pi pi-clock"
                styleClass="bg-orange-100 text-orange-700"
              />
              }

              <span class="text-xs text-gray-500">
                <i class="pi pi-calendar mr-1"></i>
                {{ todo.createdAt | date : 'short' }}
              </span>
            </div>
          </div>

          <!-- Delete Button -->
          <p-button
            icon="pi pi-trash"
            (onClick)="deleteTodo(todo.id)"
            severity="danger"
            [text]="true"
            [rounded]="true"
            size="large"
            class="shrink-0"
            pTooltip="Delete todo"
            tooltipPosition="left"
          />
        </div>
      </p-card>
      } }
    </div>
  </div>
</div>
